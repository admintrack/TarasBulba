<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Taras Bulba</title>
  <meta name="theme-color" content="#0f172a" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%230f172a'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dominant-baseline='central' font-family='system-ui' font-size='28' fill='%23ffffff'%3ETB%3C/text%3E%3C/svg%3E">

  <!-- External CSS (when this loads, we remove the inline fallback below) -->
  <link rel="stylesheet" href="./style.css" onload="document.getElementById('fallback-css')?.remove()" />

  <!-- Fallback CSS (gets removed once external CSS finishes loading) -->
  <style id="fallback-css">
    :root{--bg:#0b1220;--bg2:#0f172a;--card:#111827;--accent:#22d3ee;--good:#22c55e;--bad:#ef4444;--ink:#e5e7eb;--muted:#93a1b5;--ring:#38bdf8;--shadow:0 10px 30px rgba(0,0,0,.35);--skip:#f59e0b;--pass:#a78bfa;--reverse:#f97316}
    *{box-sizing:border-box}html,body{height:100%}body{margin:0;font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";color:var(--ink);background:radial-gradient(1200px 800px at 20% -10%,#172554 0%,transparent 60%),radial-gradient(1000px 700px at 120% 10%,#1e293b 0%,transparent 60%),linear-gradient(180deg,var(--bg),var(--bg2))}
    .app{max-width:900px;margin:0 auto;padding:20px 16px;display:flex;flex-direction:column;min-height:100%}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
    h1{font-size:1.15rem;margin:0;font-weight:700;letter-spacing:.2px}
    .table{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px}
    .board{display:grid;grid-template-columns:1fr;gap:16px;width:100%}
    .panel{display:flex;flex-direction:column;align-items:center;gap:8px}
    .panel-title{font-weight:700;color:var(--muted);letter-spacing:.2px}
    @media (min-width:700px){.board{grid-template-columns:1fr 1fr;gap:24px}}
    .card{width:min(90vw,420px);height:240px;background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid rgba(255,255,255,.06);border-radius:20px;display:grid;place-items:center;box-shadow:var(--shadow);position:relative;overflow:hidden;isolation:isolate;perspective:1200px}
    .card.reference{background:linear-gradient(180deg,#0e172a,#0c1424)}
    .card::after{content:"";position:absolute;inset:-40% -40% auto auto;width:60%;height:60%;background:conic-gradient(from 200deg,rgba(56,189,248,.18),transparent 40% 100%);filter:blur(16px);transform:rotate(8deg);pointer-events:none;z-index:-1}
    .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;backface-visibility:hidden;font-size:5rem;font-weight:800;letter-spacing:1px;color:var(--ink)}
    .face.single{backface-visibility:visible;position:relative}
    .back{transform:rotateY(180deg);font-size:3rem;color:#cbd5e1}
    .card.flipping .front{animation:flipFront 2s ease forwards}
    .card.flipping .back{animation:flipBack 2s ease forwards}
    @keyframes flipFront{0%{transform:rotateY(0)}50%{transform:rotateY(90deg)}100%{transform:rotateY(180deg)}}
    @keyframes flipBack{0%{transform:rotateY(180deg)}50%{transform:rotateY(90deg)}100%{transform:rotateY(360deg)}}
    .meta{display:flex;gap:16px;flex-wrap:wrap;align-items:center;justify-content:center;color:var(--muted)}
    .submeta{color:var(--muted);font-size:.95rem}
    .status{font-weight:600}
    .actions{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px;width:100%;max-width:560px}
    .btn{appearance:none;border:0;padding:14px 16px;border-radius:12px;cursor:pointer;background:linear-gradient(180deg,#0ea5e9,#0284c7);color:#fff;font-weight:700;letter-spacing:.3px;box-shadow:0 8px 20px rgba(2,132,199,.35);transition:transform .06s ease,filter .15s ease,box-shadow .15s ease,opacity .15s ease}
    .btn:active{transform:translateY(1px) scale(.99)}.btn.pill{border-radius:999px}
    .btn.outline{background:transparent;color:var(--ink);border:1px solid rgba(255,255,255,.2);box-shadow:none}
    .ghost{background:transparent;color:var(--ink);border:1px dashed rgba(255,255,255,.25);padding:8px 10px;border-radius:999px;font-weight:600}
    .btn.disabled{opacity:.55;pointer-events:none}
    .footer{display:flex;justify-content:center;margin-top:10px;color:var(--muted)}
    .flash-good{outline:2px solid var(--good);box-shadow:0 0 0 6px rgba(34,197,94,.18),var(--shadow)}
    .flash-bad{outline:2px solid var(--bad);box-shadow:0 0 0 6px rgba(239,68,68,.18),var(--shadow)}
    .flash-special{outline:2px solid var(--accent);box-shadow:0 0 0 6px rgba(34,211,238,.2),var(--shadow)}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);display:flex;align-items:center;justify-content:center;z-index:9999}
    .overlay.hidden{display:none}
    .overlay-content{background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:24px 28px;text-align:center;box-shadow:var(--shadow);max-width:90vw}
    .overlay-content h2{margin:0 0 12px;font-size:1.5rem;color:var(--bad)}
    .overlay-content p{margin:0 0 16px;color:var(--ink)}
  </style>
</head>
<body>
  <main class="app" data-build="v4">
    <header class="topbar">
      <h1>Taras Bulba</h1>
      <button id="installBtn" class="ghost" hidden>Install</button>
    </header>

    <section class="table">
      <div class="board">
        <!-- Deck panel -->
        <div class="panel">
          <div class="panel-title">Deck</div>
          <div id="deckCard" class="card" aria-live="polite" aria-atomic="true">
            <span class="face front" id="deckFront">?</span>
            <span class="face back" id="deckBack">?</span>
          </div>
          <div class="submeta"><span id="remaining">Deck: —</span></div>
        </div>

        <!-- Last card panel -->
        <div class="panel">
          <div class="panel-title">Last card</div>
          <div id="lastCard" class="card reference">
            <span id="lastText" class="face single">—</span>
          </div>
          <div class="submeta"><span id="refHint">Waiting…</span></div>
        </div>
      </div>

      <div class="meta"><span id="status" class="status">Tap a guess to start</span></div>

      <div class="actions">
        <button id="btnLower" class="btn pill">Lower ⬇️</button>
        <button id="btnBlank" class="btn pill">Blank ⬜</button>
        <button id="btnHigher" class="btn pill">Higher ⬆️</button>
      </div>

      <div class="toolbar">
        <button id="newGame" class="btn outline">New Round ↻</button>
      </div>
    </section>

    <footer class="footer">
      <small>Specials: Skip • Pass • Reverse keep the previous number. Calling Blank and it’s not Blank = loss. &nbsp;•&nbsp;<span id="buildTag">Build: v4</span></small>
    </footer>

    <!-- Lose Screen Overlay -->
    <div id="loseOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="loseTitle">
      <div class="overlay-content">
        <h2 id="loseTitle">Game Over</h2>
        <p id="loseMsg">You guessed wrong!</p>
        <button id="restartBtn" class="btn pill">Try Again ↻</button>
      </div>
    </div>
  </main>

  <!-- Load JS (no query string) -->
  <script src="./app.js"></script>
</body>
</html>