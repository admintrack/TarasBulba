:root{
  --bg:#0b1220; --bg2:#0f172a; --card:#111827; --accent:#22d3ee;
  --good:#22c55e; --bad:#ef4444; --ink:#e5e7eb; --muted:#93a1b5;
  --skip:#f59e0b; --pass:#a78bfa; --reverse:#f97316;
  --shadow:0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;font:16px/1.4 system-ui; color:var(--ink);
  background:linear-gradient(180deg,var(--bg),var(--bg2))}

.app{max-width:900px;margin:0 auto;padding:20px 16px;display:flex;flex-direction:column;min-height:100%}
.topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
h1{font-size:1.2rem;margin:0;font-weight:700}

.table{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px}

/* Board stacked vertically */
.board{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:20px;
  width:100%;
  position: relative;
}

.panel{display:flex;flex-direction:column;align-items:center;gap:8px}
.panel-title{font-weight:700;color:var(--muted)}

/* Shared card */
.card{
  width:min(90vw,420px);height:240px;background:var(--card);
  border-radius:20px;display:grid;place-items:center;box-shadow:var(--shadow);
  position:relative;overflow:hidden;perspective:1200px;
  border:1px solid rgba(255,255,255,.06); z-index: 1;
}
.card.reference{background:#0c1424; z-index: 2;}

/* NEW: deck stack container (static deck below + moving top card) */
.deck-stack{
  position:relative;
  width:min(90vw,420px);
  height:240px;
}

/* Static deck base shows extra backs (does NOT move) */
.card.deck-base{
  position:absolute; inset:0;
  overflow:visible; /* to show stacked backs */
  pointer-events:none;
  z-index: 1;
}
.card.deck-base::before,
.card.deck-base::after{
  content:"";
  position:absolute; inset:0;
  border-radius:18px;
  background:
    repeating-linear-gradient(45deg,#0a0f1d 0 6px,#0c1324 6px 12px);
  border:1px solid rgba(255,255,255,.08);
  box-shadow: 0 4px 12px rgba(0,0,0,.35);
}
.card.deck-base::before{ transform: translate(8px,-8px); opacity:.9; }
.card.deck-base::after { transform: translate(14px,-14px); opacity:.8; }

/* Moving top card (this is what slides/ flips) */
.card.deck-top{
  position:absolute; inset:0;
  z-index: 3; /* above base */
}
.card.on-top{ z-index: 9999; } /* ensure over the discard while sliding */

/* Faces */
.face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  font-size:5rem;font-weight:800;color:var(--ink);backface-visibility:hidden}
.face.single{backface-visibility:visible;position:relative}
.back{transform:rotateY(180deg);font-size:3rem;color:#cbd5e1}

.card.animating .front{animation:flipFront 3s ease forwards}
.card.animating .back{animation:flipBack 3s ease forwards}
@keyframes flipFront{0%{transform:rotateY(0)}50%{transform:rotateY(90deg)}100%{transform:rotateY(180deg)}}
@keyframes flipBack{0%{transform:rotateY(180deg)}50%{transform:rotateY(90deg)}100%{transform:rotateY(360deg)}}

/* Special label ONLY on the LAST card */
.card-label{
  position:absolute;
  top:8px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.6);
  color:#fff;
  padding:2px 8px;
  border-radius:6px;
  font-size:.9rem;
  font-weight:600;
  pointer-events:none;
}
.card-label.hidden{display:none}

.btn{padding:14px 16px;border-radius:12px;cursor:pointer;
  background:linear-gradient(180deg,#0ea5e9,#0284c7);color:#fff;font-weight:700;border:0}
.btn.pill{border-radius:999px}
.btn.outline{background:transparent;border:1px solid rgba(255,255,255,.3)}
.btn.disabled{opacity:.5;pointer-events:none}
.footer{display:flex;justify-content:center;margin-top:10px;color:var(--muted)}

/* Overlay must be ABOVE everything, including sliding card */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);display:flex;align-items:center;justify-content:center;z-index:100000}
.overlay.hidden{display:none}
.overlay-content{background:var(--card);padding:24px;border-radius:16px;text-align:center}
.overlay-content h2{color:var(--bad);margin:0 0 12px}